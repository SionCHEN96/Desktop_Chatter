# AI Companion

ä¸€ä¸ªåŸºäºElectronçš„3Dè™šæ‹Ÿè§’è‰²AIåŠ©æ‰‹åº”ç”¨ç¨‹åºï¼Œå…·æœ‰è‡ªç„¶è¯­è¨€äº¤äº’ã€è®°å¿†ç®¡ç†å’ŒåŠ¨ç”»ç³»ç»Ÿã€‚

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js Version](https://img.shields.io/badge/node-%3E%3D16.0.0-brightgreen)](https://nodejs.org/)
[![Electron](https://img.shields.io/badge/electron-25.2.0-blue)](https://electronjs.org/)

## é¡¹ç›®æ¦‚è¿°

AI Companionæ˜¯ä¸€ä¸ªåˆ›æ–°çš„æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œç»“åˆäº†3Dè™šæ‹Ÿè§’è‰²ã€è‡ªç„¶è¯­è¨€å¤„ç†å’Œå‘é‡æ•°æ®åº“æŠ€æœ¯ã€‚è¯¥åº”ç”¨æä¾›äº†ä¸€ä¸ªå…·æœ‰æƒ…æ„Ÿè¡¨è¾¾å’Œè®°å¿†èƒ½åŠ›çš„è™šæ‹Ÿè§’è‰²ï¼Œå¯ä»¥ä¸ç”¨æˆ·è¿›è¡Œè‡ªç„¶å¯¹è¯ï¼Œå¹¶æ ¹æ®ä¸Šä¸‹æ–‡æä¾›ä¸ªæ€§åŒ–çš„å“åº”ã€‚

### ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- ğŸ­ **3Dè™šæ‹Ÿè§’è‰²**: åŸºäºThree.jså’ŒVRMæ¨¡å‹çš„å¯äº¤äº’3Dè§’è‰²
- ğŸ’¬ **è‡ªç„¶è¯­è¨€äº¤äº’**: ä¸LM Studioé›†æˆçš„AIå¯¹è¯ç³»ç»Ÿ
- ğŸ§  **æ™ºèƒ½è®°å¿†ç®¡ç†**: ä½¿ç”¨Qdrantå‘é‡æ•°æ®åº“å­˜å‚¨å’Œæ£€ç´¢å¯¹è¯å†å²
- ğŸ¬ **åŠ¨ç”»çŠ¶æ€æœº**: æ”¯æŒå¤šç§è§’è‰²åŠ¨ç”»çŠ¶æ€ï¼ˆå¾…æœºã€æ€è€ƒã€æƒ…æ„Ÿè¡¨è¾¾ç­‰ï¼‰
- ğŸ–¥ï¸ **è·¨å¹³å°æ¡Œé¢åº”ç”¨**: åŸºäºElectronçš„ç°ä»£æ¡Œé¢åº”ç”¨ç¨‹åº
- ğŸ”§ **æ¨¡å—åŒ–æ¶æ„**: é‡‡ç”¨æœåŠ¡åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤
- ğŸ“ **ç»“æ„åŒ–æ—¥å¿—**: å®Œæ•´çš„æ—¥å¿—è®°å½•å’Œé”™è¯¯å¤„ç†ç³»ç»Ÿ
- âš¡ **é«˜æ€§èƒ½**: ä¼˜åŒ–çš„å†…å­˜ç®¡ç†å’Œæ¸²æŸ“æ€§èƒ½

### ğŸ—ï¸ æ¶æ„ç‰¹ç‚¹

- **æœåŠ¡åŒ–æ¶æ„**: ä¸»è¿›ç¨‹é‡‡ç”¨æ¨¡å—åŒ–æœåŠ¡è®¾è®¡
- **ç»„ä»¶åŒ–UI**: æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨å¯å¤ç”¨ç»„ä»¶æ¶æ„
- **ç»Ÿä¸€é”™è¯¯å¤„ç†**: å®Œæ•´çš„é”™è¯¯åˆ†ç±»å’Œæ¢å¤æœºåˆ¶
- **ç±»å‹å®‰å…¨**: å®Œå–„çš„JSDocç±»å‹å®šä¹‰
- **é…ç½®é©±åŠ¨**: çµæ´»çš„é…ç½®ç®¡ç†ç³»ç»Ÿ

## å¿«é€Ÿå¼€å§‹æŒ‡å—

### ç³»ç»Ÿè¦æ±‚

- Node.js 16.x æˆ–æ›´é«˜ç‰ˆæœ¬
- npm 8.x æˆ–æ›´é«˜ç‰ˆæœ¬
- Docker (å¯é€‰ï¼Œç”¨äºQdrantæ•°æ®åº“)
- LM Studio (ç”¨äºæœ¬åœ°AIæ¨¡å‹)

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd ai-companion
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **å¯åŠ¨Qdrantæ•°æ®åº“**
   
   æœ‰ä¸¤ç§æ–¹å¼å¯åŠ¨Qdrantæ•°æ®åº“:
   
   **æ–¹å¼ä¸€ï¼šä½¿ç”¨Docker (æ¨è)**
   ```bash
   npm run start-with-db
   ```
   
   **æ–¹å¼äºŒï¼šä½¿ç”¨Node.js**
   ```bash
   npm run start-with-db-node
   ```

4. **å¯åŠ¨åº”ç”¨**
   ```bash
   npm start
   ```

### ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ config/                 # ğŸ“‹ é…ç½®æ¨¡å—
â”‚   â”œâ”€â”€ aiConfig.js         # AIæœåŠ¡é…ç½®
â”‚   â”œâ”€â”€ uiConfig.js         # UIä¸»é¢˜é…ç½®
â”‚   â”œâ”€â”€ animationConfig.js  # åŠ¨ç”»é…ç½®
â”‚   â”œâ”€â”€ appConfig.js        # åº”ç”¨é…ç½®ï¼ˆé‡æ–°å¯¼å‡ºï¼‰
â”‚   â””â”€â”€ index.js            # é…ç½®ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ core/                   # ğŸ”§ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ animation/          # åŠ¨ç”»çŠ¶æ€æœºç³»ç»Ÿ
â”‚   â”œâ”€â”€ character/          # 3Dè§’è‰²ç®¡ç†
â”‚   â”œâ”€â”€ memory/             # æ™ºèƒ½è®°å¿†ç®¡ç†
â”‚   â””â”€â”€ index.js            # æ ¸å¿ƒæ¨¡å—ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ main/                   # ğŸ–¥ï¸ ä¸»è¿›ç¨‹ï¼ˆæœåŠ¡åŒ–æ¶æ„ï¼‰
â”‚   â”œâ”€â”€ services/           # æœåŠ¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ aiService.js    # AIå¤„ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ windowService.js # çª—å£ç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ipcService.js   # IPCé€šä¿¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ memoryService.js # å†…å­˜ç®¡ç†æœåŠ¡
â”‚   â”‚   â””â”€â”€ index.js        # æœåŠ¡ç»Ÿä¸€å¯¼å‡º
â”‚   â”œâ”€â”€ main.cjs            # ä¸»è¿›ç¨‹å…¥å£ï¼ˆCommonJSï¼‰
â”‚   â””â”€â”€ main.js             # ä¸»è¿›ç¨‹é€»è¾‘ï¼ˆES Modulesï¼‰
â”œâ”€â”€ renderer/               # ğŸ¨ æ¸²æŸ“è¿›ç¨‹ï¼ˆç»„ä»¶åŒ–ï¼‰
â”‚   â”œâ”€â”€ components/         # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ MessageManager.js # æ¶ˆæ¯ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ InputManager.js # è¾“å…¥ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatContainer.js # èŠå¤©å®¹å™¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ CharacterManager.js # è§’è‰²ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ WindowControls.js # çª—å£æ§åˆ¶ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ App.js          # åº”ç”¨æ ¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ index.js        # ç»„ä»¶ç»Ÿä¸€å¯¼å‡º
â”‚   â””â”€â”€ renderer.js         # æ¸²æŸ“è¿›ç¨‹å…¥å£
â”œâ”€â”€ ui/                     # ğŸ¯ å¯å¤ç”¨UIç»„ä»¶
â”‚   â”œâ”€â”€ MessageComponent.js # æ¶ˆæ¯æ˜¾ç¤ºç»„ä»¶
â”‚   â”œâ”€â”€ MessageComponent.css # æ¶ˆæ¯æ ·å¼
â”‚   â””â”€â”€ index.js            # UIç»„ä»¶ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ utils/                  # ğŸ› ï¸ å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ logger.js           # ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ
â”‚   â”œâ”€â”€ errorHandler.js     # ç»Ÿä¸€é”™è¯¯å¤„ç†
â”‚   â””â”€â”€ index.js            # å·¥å…·ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ types/                  # ğŸ“ ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.js            # TypeScripté£æ ¼ç±»å‹å®šä¹‰
â”œâ”€â”€ styles/                 # ğŸ¨ å…¨å±€æ ·å¼æ–‡ä»¶
â””â”€â”€ index.js                # ğŸš€ æ ¹çº§ç»Ÿä¸€å¯¼å‡º
```

### ğŸ› ï¸ å¼€å‘æŒ‡å—

#### ä»£ç è§„èŒƒ

- **æ¨¡å—ç³»ç»Ÿ**: ä½¿ç”¨ES6æ¨¡å—ç³»ç»Ÿï¼Œæ”¯æŒç»Ÿä¸€å¯¼å…¥å¯¼å‡º
- **å‘½åè§„èŒƒ**:
  - æ–‡ä»¶åä½¿ç”¨PascalCaseï¼ˆå¦‚`MessageManager.js`ï¼‰
  - å˜é‡å’Œå‡½æ•°ä½¿ç”¨camelCase
  - å¸¸é‡ä½¿ç”¨UPPER_SNAKE_CASE
- **æ¶æ„åŸåˆ™**:
  - æœåŠ¡åŒ–è®¾è®¡ï¼ŒèŒè´£åˆ†ç¦»
  - ç»„ä»¶åŒ–å¼€å‘ï¼Œæé«˜å¤ç”¨æ€§
  - ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

#### æ¨¡å—å¯¼å…¥æœ€ä½³å®è·µ

```javascript
// âœ… æ¨èï¼šä½¿ç”¨ç»Ÿä¸€å¯¼å‡º
import { AIService, WindowService } from '../main/services/index.js';
import { MessageManager, InputManager } from '../renderer/components/index.js';
import { createLogger, handleError } from '../utils/index.js';

// âœ… æˆ–è€…ä»æ ¹çº§å¯¼å…¥
import { AnimationStateMachine, MemoryManager } from '../src/index.js';

// âŒ é¿å…ï¼šæ·±å±‚æ¬¡å¯¼å…¥
import { AIService } from '../main/services/aiService.js';
```

#### æ·»åŠ æ–°åŠŸèƒ½

1. **æ ¸å¿ƒåŠŸèƒ½æ¨¡å—**
   ```bash
   # åœ¨ src/core/ ä¸‹åˆ›å»ºæ–°æ¨¡å—
   mkdir src/core/newFeature
   touch src/core/newFeature/index.js
   ```

2. **æœåŠ¡æ¨¡å—**
   ```bash
   # åœ¨ src/main/services/ ä¸‹åˆ›å»ºæ–°æœåŠ¡
   touch src/main/services/newService.js
   # æ›´æ–° src/main/services/index.js å¯¼å‡º
   ```

3. **UIç»„ä»¶**
   ```bash
   # åœ¨ src/renderer/components/ ä¸‹åˆ›å»ºæ–°ç»„ä»¶
   touch src/renderer/components/NewComponent.js
   # æ›´æ–° src/renderer/components/index.js å¯¼å‡º
   ```

#### æ—¥å¿—å’Œé”™è¯¯å¤„ç†

```javascript
// åˆ›å»ºæ¨¡å—ä¸“ç”¨æ—¥å¿—å™¨
import { createLogger, handleError, ErrorType } from '../utils/index.js';
const logger = createLogger('MyModule');

// è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—
logger.info('æ“ä½œæˆåŠŸ', { userId: 123 });
logger.warn('è­¦å‘Šä¿¡æ¯', { context: 'additional info' });
logger.error('é”™è¯¯ä¿¡æ¯', error);

// ç»Ÿä¸€é”™è¯¯å¤„ç†
try {
  // å¯èƒ½å‡ºé”™çš„æ“ä½œ
} catch (error) {
  await handleError(error, { module: 'MyModule' });
}
```

#### è°ƒè¯•æŠ€å·§

- **ç»“æ„åŒ–æ—¥å¿—**: ä½¿ç”¨å†…ç½®æ—¥å¿—ç³»ç»Ÿæ›¿ä»£`console.log`
- **é”™è¯¯è¿½è¸ª**: æŸ¥çœ‹è¯¦ç»†çš„é”™è¯¯å †æ ˆå’Œä¸Šä¸‹æ–‡ä¿¡æ¯
- **å¼€å‘å·¥å…·**:
  - Electron DevToolsç”¨äºæ¸²æŸ“è¿›ç¨‹è°ƒè¯•
  - ä¸»è¿›ç¨‹æ—¥å¿—æŸ¥çœ‹ç»ˆç«¯è¾“å‡º
  - Qdrant Web UI (http://localhost:6333/dashboard) æ£€æŸ¥å‘é‡æ•°æ®åº“

### ğŸ”§ é…ç½®è¯´æ˜

#### AIé…ç½®
```javascript
// src/config/aiConfig.js
export const LM_STUDIO_CONFIG = {
  BASE_URL: 'http://127.0.0.1:1234',  // LM Studio APIåœ°å€
  MODEL: 'deepseek/deepseek-r1-0528-qwen3-8b',  // æ¨¡å‹åç§°
  TEMPERATURE: 0.7  // å“åº”éšæœºæ€§
};
```

#### UIä¸»é¢˜é…ç½®
```javascript
// src/config/uiConfig.js
export const THEME_CONFIG = {
  colors: {
    primary: '#007bff',
    userMessage: '#dcf8c6',
    aiMessage: '#ffffff'
  }
};
```

### ğŸ“Š æ€§èƒ½ä¼˜åŒ–

- **å†…å­˜ç®¡ç†**: è‡ªåŠ¨é™çº§ç­–ç•¥ï¼ˆQdrant â†’ ChromaDB â†’ å†…å­˜å­˜å‚¨ï¼‰
- **é”™è¯¯æ¢å¤**: æ™ºèƒ½é”™è¯¯å¤„ç†å’Œè‡ªåŠ¨é‡è¯•æœºåˆ¶
- **æ—¥å¿—ä¼˜åŒ–**: ç»“æ„åŒ–æ—¥å¿—ï¼Œæ”¯æŒä¸åŒçº§åˆ«å’Œé¢œè‰²è¾“å‡º
- **æ¨¡å—åŠ è½½**: æŒ‰éœ€åŠ è½½ï¼Œå‡å°‘å¯åŠ¨æ—¶é—´

### ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### ğŸ“‹ å¸¸è§é—®é¢˜

**Q: å¯åŠ¨æ—¶å‡ºç°Qdrantè¿æ¥é”™è¯¯**
A: é¡¹ç›®ä¼šè‡ªåŠ¨é™çº§åˆ°ChromaDBæˆ–å†…å­˜å­˜å‚¨ã€‚æ£€æŸ¥æ—¥å¿—äº†è§£å½“å‰ä½¿ç”¨çš„å­˜å‚¨ç­–ç•¥ã€‚

**Q: 3Dè§’è‰²æ— æ³•æ˜¾ç¤º**
A: æ£€æŸ¥æ§åˆ¶å°WebGLé”™è¯¯ï¼Œç¡®ä¿æ˜¾å¡é©±åŠ¨æ”¯æŒWebGLã€‚é¡¹ç›®å·²æ·»åŠ GPUå…¼å®¹æ€§å‚æ•°ã€‚

**Q: AIå“åº”ç¼“æ…¢æˆ–å¤±è´¥**
A: ç¡®è®¤LM Studioæ­£åœ¨è¿è¡Œä¸”æ¨¡å‹å·²åŠ è½½ã€‚æŸ¥çœ‹ç»“æ„åŒ–æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚

**Q: å¦‚ä½•æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**
A: æ—¥å¿—ä¼šåœ¨ç»ˆç«¯æ˜¾ç¤ºï¼Œæ”¯æŒé¢œè‰²ç¼–ç ã€‚å¯ä»¥é€šè¿‡è®¾ç½®æ—¥å¿—çº§åˆ«æ§åˆ¶è¾“å‡ºè¯¦ç»†ç¨‹åº¦ã€‚

**Q: å¦‚ä½•æ·»åŠ æ–°çš„åŠ¨ç”»**
A: åœ¨`src/config/animationConfig.js`ä¸­æ·»åŠ åŠ¨ç”»é…ç½®ï¼Œç„¶ååœ¨åŠ¨ç”»çŠ¶æ€æœºä¸­å®šä¹‰çŠ¶æ€ã€‚

### ğŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®æ¶æ„è¯´æ˜](./ARCHITECTURE.md) - è¯¦ç»†çš„æ¶æ„è®¾è®¡æ–‡æ¡£
- [ä¼˜åŒ–æ€»ç»“](./OPTIMIZATION_SUMMARY.md) - æœ€æ–°çš„ç»“æ„ä¼˜åŒ–è¯´æ˜
- [APIæ–‡æ¡£](./docs/API.md) - æœåŠ¡å’Œç»„ä»¶APIæ–‡æ¡£ï¼ˆå¾…æ·»åŠ ï¼‰

### ğŸ”„ ç‰ˆæœ¬å†å²

- **v1.1.0** - ç»“æ„ä¼˜åŒ–ç‰ˆæœ¬
  - å®ç°æœåŠ¡åŒ–æ¶æ„
  - æ·»åŠ ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œæ—¥å¿—ç³»ç»Ÿ
  - ä¼˜åŒ–æ¨¡å—å¯¼å…¥å¯¼å‡ºç»“æ„
  - å®Œå–„ç±»å‹å®šä¹‰å’Œæ–‡æ¡£

- **v1.0.0** - åˆå§‹ç‰ˆæœ¬
  - åŸºç¡€3Dè§’è‰²å’ŒAIå¯¹è¯åŠŸèƒ½
  - Qdrantå‘é‡æ•°æ®åº“é›†æˆ
  - åŸºç¡€åŠ¨ç”»ç³»ç»Ÿ

### ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº [MIT License](LICENSE) å¼€æºã€‚

### ğŸ™ è‡´è°¢

- [Three.js](https://threejs.org/) - 3Då›¾å½¢åº“
- [Electron](https://electronjs.org/) - è·¨å¹³å°æ¡Œé¢åº”ç”¨æ¡†æ¶
- [Qdrant](https://qdrant.tech/) - å‘é‡æ•°æ®åº“
- [LM Studio](https://lmstudio.ai/) - æœ¬åœ°AIæ¨¡å‹è¿è¡Œç¯å¢ƒ